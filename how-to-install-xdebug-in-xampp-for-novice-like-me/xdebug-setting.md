# Xdebugの設定

## string xdebug.mode

この設定は、どのXdebug機能を有効にするかを制御します。

*注記*

この設定は、php.ini、またはPHPプロセスの開始時に(直接またはphp-fpm経由で)読み取られる99-xdebug.iniなどのファイルでのみ設定できます。この値は、リクエストごとに読み取られる.htaccessおよび.user.iniファイルに設定することも、ApacheVHOSTやPHP-FPMプールで使用されるphp_admin_valueを介して設定することもできません。

次の値が受け入れられます。

off<br>
何も有効になっていません。Xdebugは、機能が有効になっているかどうかを確認する以外には機能しません。オーバーヘッドを0に近づけたい場合は、この設定を使用します。

develop<br>
オーバーロードされたvar_dump()を含む開発ヘルパーを有効にします。

coverage<br>
主にPHPUnitと組み合わせて、コードカバレッジ分析でコードカバレッジレポートを生成できるようにします。

debug<br>
ステップデバッグを有効にします。これを使用すると、実行中にコードをステップ実行し、変数の値を分析できます。

gcstats<br>
ガベージコレクション統計を有効にして、PHPのガベージコレクションメカニズムに関する統計を収集します。

profile<br>
プロファイリングを有効にすると、KCacheGrindなどのツールを使用してパフォーマンスのボトルネックを分析できます。

trace<br>
関数トレース機能を有効にすると、ファイルへのリクエスト中に行われる引数、変数の割り当て、戻り値を含むすべての関数呼び出しを記録できます。

xdebug.modeの値として識別子をカンマで区切ることで、複数のモードを同時に有効にできます:xdebug.mode=develop,trace。

XDEBUG_MODE環境変数

コマンドラインでXDEBUG_MODE環境変数を設定することによって、Xdebugのモードを設定することもできます。これはxdebug.mode設定より優先されますが、xdebug.mode設定の値は変更されません。

*警告*

一部のWebサーバーには、環境変数がPHPおよびXdebugに伝達されるのを防ぐ構成オプションがあります。

たとえば、PHP-FPMにはデフォルトでオンになっているclear_env構成設定がありますが、XDEBUG_MODEを使用する場合はオフにする必要があります。

Webサーバーが環境をクリーンアップしていないこと、または特にXDEBUG_MODE環境変数の受け渡しを許可していないことを確認してください。

## string xdebug.start_with_request

関数トレース、ガベージコレクション統計、プロファイリング、またはステップデバッグは、PHPリクエストの開始時にアクティブ化できます。これが起こるかどうかは、この設定の値によって決まります。

yes<br>
この機能は、PHPリクエストの開始時、およびPHPコードが実行される前に開始されます。

たとえば、xdebug.mode=traceおよびxdebug.start_with_request=yesは、リクエスト全体の関数トレースを開始します。

no<br>
この機能は、リクエストの開始時にアクティブ化されません。

xdebug_start_trace()を使用して関数トレースを開始したり、xdebug_break()を使用してステップデバッグを開始したり、xdebug_start_gcstats()を使用してガベージコレクション統計を開始したりすることはできます。

trigger<br>
この機能は、リクエストの開始時に特定のトリガーが存在する場合にのみアクティブになります。

トリガーの名前はXDEBUG_TRIGGERで、Xdebugは$_ENV(環境変数)、$_GETまたは$_POST変数、または$_COOKIE(HTTPCookie名)のいずれかにトリガーが存在するかどうかをチェックします。

機能固有のトリガー名、XDEBUG_PROFILE(プロファイリング用)、XDEBUG_TRACE(関数トレース用)、およびXDEBUG_SESSION(ステップデバッグ用)へのレガシーフォールバックがあります。

別のレガシートリガーがあります。XDEBUG_CONFIG環境変数を任意の値に設定すると、Xdebugもアクティブ化されます。

ステップデバッグのデバッグセッション管理は、XDEBUG_SESSION_STARTからも利用できます。

xdebug.trigger_valueを使用すると、どの特定のトリガー値でトリガーをアクティブにするかを制御できます。xdebug.trigger_valueが空の文字列に設定されている場合、任意の値が受け入れられます。

default<br>
デフォルト値はxdebug.modeによって異なります。

-debug: trigger
-gcstats: no
-profile: yes
-trace: trigger

## string xdebug.idekey

*注記*

Xdebugがデバッグクライアントまたはプロキシに渡すIDEキーを制御します。IDEキーはDBGpプロキシツールで使用する場合にのみ重要ですが、一部のIDEはその値が何であるかを誤って選択します。

デフォルトはDBGP_IDEKEY環境設定に基づきます。存在しない場合、デフォルトは空の文字列に戻ります。

この設定が空ではない文字列に設定されている場合、DBGP_IDEKEY環境変数ではなくその値がデフォルト値として選択されます。

内部IDEキーも、デバッグセッション管理を通じて更新され、ステップデバッグのドキュメントで説明されているように、この設定の値をオーバーライドします。

この設定は、XDEBUG_CONFIG環境変数を通じてさらに構成できます。